<!-- Button -->
<button
    type="button"
    pButton
    class="languages-trigger p-button-rounded p-button-text p-button-icon-only"
    (click)="languagesPopover.toggle($event)">
    <ng-container *ngTemplateOutlet="flagImage; context: {$implicit: activeLang}"></ng-container>
</button>

<!-- Language popover -->
<p-popover
    #languagesPopover
    [styleClass]="'languages-popover'">
    <ng-template pTemplate="content">
        <div class="flex flex-col py-2">
            <ng-container *ngFor="let lang of availableLangs; trackBy: trackByFn">
                <button
                    type="button"
                    class="flex items-center w-full px-4 py-2 text-left hover:bg-gray-100 dark:hover:bg-hover"
                    (click)="setActiveLang(lang.id)">
                    <ng-container *ngTemplateOutlet="flagImage; context: {$implicit: lang.id}"></ng-container>
                    <span class="ml-3">{{lang.label}}</span>
                </button>
            </ng-container>
        </div>
    </ng-template>
</p-popover>

<!-- Flag image template -->
<ng-template
    let-lang
    #flagImage>
    <span class="relative w-6 shadow rounded-sm overflow-hidden">
        <span class="absolute inset-0 ring-1 ring-inset ring-black ring-opacity-10"></span>
        <img
            class="w-full"
            [src]="'assets/images/flags/' + flagCodes[lang].toUpperCase() + '.svg'"
            [alt]="'Flag image for ' + lang">
    </span>
</ng-template>
